% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/add_refugia.R
\name{add_refugia}
\alias{add_refugia}
\title{Add Refugia Attributes to Mesohabitat Polygons}
\usage{
add_refugia(
  poly_mesohabitats,
  flow,
  poly_BOULDER,
  poly_CANOP_SHAD,
  poly_OVERHA_VEG,
  poly_ROOTS,
  poly_SUBMER_VEG,
  poly_EMERG_VEG,
  poly_UNDERC_BAN,
  poly_WOODY_DEBR,
  poly_RIPRAP,
  poly_SHALL_MARG,
  file_name = "mesohabitats.shp"
)
}
\arguments{
\item{poly_mesohabitats}{An \code{sf} object with mesohabitat polygons.}

\item{flow}{An \code{sf} object with flow points containing at least the columns
\code{Z} (bed elevation) and \code{DEPTH} (water depth).}

\item{poly_BOULDER, poly_CANOP_SHAD, poly_OVERHA_VEG, poly_ROOTS, }{poly_SUBMER_VEG,poly_EMERG_VEG,poly_UNDERC_BAN,poly_WOODY_DEBR,
poly_RIPRAP,poly_SHALL_MARG Optional \code{sf} polygon layers representing
different types of refugia (may be \code{NULL}).}

\item{file_name}{Character string with the output shapefile path and name. Default: 'mesohabitats.shp'}
}
\value{
Invisibly returns the updated \code{sf} object with added refuge and
connectivity attributes.
}
\description{
This function adds refuge-related attributes (e.g., boulders, vegetation, roots)
and hydraulic connectivity information to mesohabitat polygons, and saves the
result as a shapefile compatible with SimStream or MesoHABSIM workflows.
}
\details{
For each mesohabitat polygon, the function checks for spatial intersections
with various refugia polygons (if provided) and flags their presence as
\code{"True"} or \code{"False"}. Connectivity between neighboring units is determined by
testing for intersections after buffering each polygon by 3 meters.

The minimum and maximum water surface elevation (WSE = Z + DEPTH) for each unit are
also computed from the flow points located within the polygon.
}
\examples{
\dontrun{
poly_mesoHABSIM <- add_refugia(
  poly_mesohabitats = poly_mesohabitats,
  flow = flow_ZDV,
  poly_BOULDER = poly_boulders,
  poly_CANOP_SHAD = poly_canopyshading,
  poly_OVERHA_VEG = poly_overhang,
  poly_ROOTS = poly_roots,
  poly_SUBMER_VEG = NULL,
  poly_EMERG_VEG = NULL,
  poly_UNDERC_BAN = NULL,
  poly_WOODY_DEBR = poly_woodydebris,
  poly_RIPRAP = NULL,
  poly_SHALL_MARG = NULL,
  file_name = "mesohabitats.shp"
)
}

}
